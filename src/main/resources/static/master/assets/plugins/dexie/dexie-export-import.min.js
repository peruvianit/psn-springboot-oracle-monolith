!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("dexie")):"function"==typeof define&&define.amd?define(["exports","dexie"],t):t(e.DexieExportImport={},e.Dexie)}(this,function(e,t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
function n(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})}function r(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function i(e,t){return new Promise(function(n,r){var i=new FileReader;i.onabort=function(e){return r(new Error("file read aborted"))},i.onerror=function(e){return r(e.target.error)},i.onload=function(e){return n(e.target.result)},"binary"===t?i.readAsArrayBuffer(e):i.readAsText(e)})}function o(e,t){if("undefined"==typeof FileReaderSync)throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var n=new FileReaderSync;return"binary"===t?n.readAsArrayBuffer(e):n.readAsText(e)}t=t&&t.hasOwnProperty("default")?t.default:t;var s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e,t){return e(t={exports:{}},t.exports),t.exports}var u=a(function(e,t){e.exports=function(){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},r=Object.keys,i=Array.isArray,o={}.toString,s=Object.getPrototypeOf,a={}.hasOwnProperty,u=a.toString,c=["type","replaced","iterateIn","iterateUnsetNumeric"];function f(e,t){return y.isObject(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function l(e){return o.call(e).slice(8,-1)}function h(t,n){if(!t||"object"!==(void 0===t?"undefined":e(t)))return!1;var r=s(t);if(!r)return!1;var i=a.call(r,"constructor")&&r.constructor;return"function"!=typeof i?null===n:"function"==typeof i&&null!==n&&u.call(i)===u.call(n)}function p(e){return!(!e||"Object"!==l(e))&&(!s(e)||h(e,Object))}function d(t){return t&&"object"===(void 0===t?"undefined":e(t))}function y(o){var s=[],a=[],u={},l=this.types={},g=this.stringify=function(e,t,n,r){r=Object.assign({},o,r,{stringification:!0});var s=A(e,null,r);return i(s)?JSON.stringify(s[0],t,n):s.then(function(e){return JSON.stringify(e,t,n)})};this.stringifySync=function(e,t,n,r){return g(e,t,n,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!0}))},this.stringifyAsync=function(e,t,n,r){return g(e,t,n,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!1}))};var E=this.parse=function(e,t,n){return n=Object.assign({},o,n,{parse:!0}),S(JSON.parse(e,t),n)};this.parseSync=function(e,t,n){return E(e,t,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!0}))},this.parseAsync=function(e,t,n){return E(e,t,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!1}))},this.specialTypeNames=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.returnTypeNames=!0,this.encapsulate(e,t,n)},this.rootTypeName=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.iterateNone=!0,this.encapsulate(e,t,n)};var A=this.encapsulate=function(f,l,v){var g=(v=Object.assign({sync:!0},o,v)).sync,m={},w=[],E=[],A=[],S=!(v&&"cyclic"in v)||v.cyclic,T=v.encapsulateObserver,N=B("",f,S,l||{},A);function j(e){var t=Object.values(m);if(v.iterateNone)return t.length?t[0]:y.getJSONType(e);if(t.length){if(v.returnTypeNames)return[].concat(n(new Set(t)));e&&p(e)&&!e.hasOwnProperty("$types")?e.$types=m:e={$:e,$types:{$:m}}}else d(e)&&e.hasOwnProperty("$types")&&(e={$:e,$types:!0});return!v.returnTypeNames&&e}return A.length?g&&v.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(function e(n,r){return Promise.all(r.map(function(e){return e[1].p})).then(function(i){return Promise.all(i.map(function(i){var o=[],s=r.splice(0,1)[0],a=t(s,7),u=a[0],c=a[2],f=a[3],l=a[4],p=a[5],d=a[6],y=B(u,i,c,f,o,!0,d),v=h(y,O);return u&&v?y.p.then(function(t){return l[p]=t,e(n,o)}):(u?l[p]=y:n=v?y.p:y,e(n,o))}))}).then(function(){return n})}(N,A)).then(j):!g&&v.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():v.stringification&&g?[j(N)]:g?j(N):Promise.resolve(j(N));function _(e,t,n){Object.assign(e,t);var r=c.map(function(t){var n=e[t];return delete e[t],n});n(),c.forEach(function(t,n){e[t]=r[n]})}function B(t,n,o,a,u,c,f){var l=void 0,d={},g=void 0===n?"undefined":e(n),A=T?function(e){var r=f||a.type||y.getJSONType(n);T(Object.assign(e||d,{keypath:t,value:n,cyclic:o,stateObj:a,promisesData:u,resolvingTypesonPromise:c,awaitingTypesonPromise:h(n,O)},void 0!==r?{type:r}:{}))}:null;if(g in{string:1,boolean:1,number:1,undefined:1})return void 0===n||"number"===g&&(isNaN(n)||n===-1/0||n===1/0)?(l=x(t,n,a,u,!1,c,A))!==n&&(d={replaced:l}):l=n,A&&A(),l;if(null===n)return A&&A(),n;if(o&&!a.iterateIn&&!a.iterateUnsetNumeric){var S=w.indexOf(n);if(!(S<0))return m[t]="#",A&&A({cyclicKeypath:E[S]}),"#"+E[S];!0===o&&(w.push(n),E.push(t))}var N=p(n),j=i(n),C=(N||j)&&(!s.length||a.replaced)||a.iterateIn?n:x(t,n,a,u,N||j,null,A),U=void 0;if(C!==n?(l=C,d={replaced:C}):j||"array"===a.iterateIn?(U=new Array(n.length),d={clone:U}):N||"object"===a.iterateIn?d={clone:U={}}:""===t&&h(n,O)?(u.push([t,n,o,a,void 0,void 0,a.type]),l=n):l=n,A&&A(),v.iterateNone)return U||l;if(!U)return l;if(a.iterateIn){var I=function(e){var r={ownKeys:n.hasOwnProperty(e)};_(a,r,function(){var r=t+(t?".":"")+b(e),i=B(r,n[e],!!o,a,u,c);h(i,O)?u.push([r,i,!!o,a,U,e,a.type]):void 0!==i&&(U[e]=i)})};for(var L in n)I(L);A&&A({endIterateIn:!0,end:!0})}else r(n).forEach(function(e){var r=t+(t?".":"")+b(e);_(a,{ownKeys:!0},function(){var t=B(r,n[e],!!o,a,u,c);h(t,O)?u.push([r,t,!!o,a,U,e,a.type]):void 0!==t&&(U[e]=t)})}),A&&A({endIterateOwn:!0,end:!0});if(a.iterateUnsetNumeric){for(var P=n.length,k=function(e){if(!(e in n)){var r=t+(t?".":"")+e;_(a,{ownKeys:!1},function(){var t=B(r,void 0,!!o,a,u,c);h(t,O)?u.push([r,t,!!o,a,U,e,a.type]):void 0!==t&&(U[e]=t)})}},R=0;R<P;R++)k(R);A&&A({endIterateUnsetNumeric:!0,end:!0})}return U}function x(e,t,n,r,i,o,c){for(var f=i?s:a,l=f.length;l--;){var h=f[l];if(h.test(t,n)){var p=h.type;if(u[p]){var d=m[e];m[e]=d?[p].concat(d):p}return Object.assign(n,{type:p,replaced:!0}),!g&&h.replaceAsync||h.replace?(c&&c({replacing:!0}),B(e,h[g||!h.replaceAsync?"replace":"replaceAsync"](t,n),S&&"readonly",n,r,o,p)):(c&&c({typeDetected:!0}),B(e,t,S&&"readonly",n,r,o,p))}}return t}};this.encapsulateSync=function(e,t,n){return A(e,t,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!0}))},this.encapsulateAsync=function(e,t,n){return A(e,t,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!1}))};var S=this.revive=function(e,n){var s=(n=Object.assign({sync:!0},o,n)).sync,a=e&&e.$types,c=!0;if(!a)return e;if(!0===a)return e.$;a.$&&p(a.$)&&(e=e.$,a=a.$,c=!1);var l=[],d={},y=function e(n,o,s,f,y,v){if(!c||"$types"!==n){var g=a[n];if(i(o)||p(o)){var O=i(o)?new Array(o.length):{};for(r(o).forEach(function(t){var r=e(n+(n?".":"")+b(t),o[t],s||O,f,O,t);h(r,w)?O[t]=void 0:void 0!==r&&(O[t]=r)}),o=O;l.length;){var E=t(l[0],4),A=E[0],S=E[1],T=E[2],N=E[3],j=m(A,S);if(h(j,w))T[N]=void 0;else{if(void 0===j)break;T[N]=j}l.splice(0,1)}}if(!g)return o;if("#"===g){var _=m(s,o.substr(1));return void 0===_&&l.push([s,o.substr(1),y,v]),_}var B=f.sync;return[].concat(g).reduce(function(e,t){var n=u[t];if(!n)throw new Error("Unregistered type: "+t);return n[B&&n.revive?"revive":!B&&n.reviveAsync?"reviveAsync":"revive"](e,d)},o)}}("",e,null,n);return f(y=h(y,w)?void 0:y)?s&&n.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():y:!s&&n.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():s?y:Promise.resolve(y)};this.reviveSync=function(e,t){return S(e,Object.assign({},{throwOnBadSyncType:!0},t,{sync:!0}))},this.reviveAsync=function(e,t){return S(e,Object.assign({},{throwOnBadSyncType:!0},t,{sync:!1}))},this.register=function(e,t){return t=t||{},[].concat(e).forEach(function e(n){if(i(n))return n.map(e);n&&r(n).forEach(function(e){if("#"===e)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(y.JSON_TYPES.includes(e))throw new TypeError("Plain JSON object types are reserved as type names");var r=n[e],o=r.testPlainObjects?s:a,c=o.filter(function(t){return t.type===e});if(c.length&&(o.splice(o.indexOf(c[0]),1),delete u[e],delete l[e]),r){if("function"==typeof r){var f=r;r={test:function(e){return e&&e.constructor===f},replace:function(e){return v({},e)},revive:function(e){return v(Object.create(f.prototype),e)}}}else i(r)&&(r={test:r[0],replace:r[1],revive:r[2]});var h={type:e,test:r.test.bind(r)};r.replace&&(h.replace=r.replace.bind(r)),r.replaceAsync&&(h.replaceAsync=r.replaceAsync.bind(r));var p="number"==typeof t.fallback?t.fallback:t.fallback?0:1/0;if(r.testPlainObjects?s.splice(p,0,h):a.splice(p,0,h),r.revive||r.reviveAsync){var d={};r.revive&&(d.revive=r.revive.bind(r)),r.reviveAsync&&(d.reviveAsync=r.reviveAsync.bind(r)),u[e]=d}l[e]=r}})}),this}}function v(e,t){return r(t).map(function(n){e[n]=t[n]}),e}function b(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function g(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function m(e,t){if(""===t)return e;var n=t.indexOf(".");if(n>-1){var r=e[g(t.substr(0,n))];return void 0===r?void 0:m(r,t.substr(n+1))}return e[g(t)]}function w(){}function O(e){this.p=new Promise(e)}return O.prototype.then=function(e,t){var n=this;return new O(function(r,i){n.p.then(function(t){r(e?e(t):t)},function(e){n.p.catch(function(e){return t?t(e):Promise.reject(e)}).then(r,i)})})},O.prototype.catch=function(e){return this.then(null,e)},O.resolve=function(e){return new O(function(t){t(e)})},O.reject=function(e){return new O(function(t,n){n(e)})},["all","race"].map(function(e){O[e]=function(t){return new O(function(n,r){Promise[e](t.map(function(e){return e.p})).then(n,r)})}}),y.Undefined=w,y.Promise=O,y.isThenable=f,y.toStringTag=l,y.hasConstructorOf=h,y.isObject=d,y.isPlainObject=p,y.isUserObject=function e(t){if(!t||"Object"!==l(t))return!1;var n=s(t);return!n||h(t,Object)||e(n)},y.escapeKeyPathComponent=b,y.unescapeKeyPathComponent=g,y.getByKeyPath=m,y.getJSONType=function(t){return null===t?"null":i(t)?"array":void 0===t?"undefined":e(t)},y.JSON_TYPES=["null","boolean","number","string","array","object"],y}()}),c=a(function(e,t){e.exports=function(){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},r=Object.keys,i=Array.isArray,o={}.toString,a=Object.getPrototypeOf,u={}.hasOwnProperty,c=u.toString,f=["type","replaced","iterateIn","iterateUnsetNumeric"];function l(e,t){return v.isObject(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function h(e){return o.call(e).slice(8,-1)}function p(t,n){if(!t||"object"!==(void 0===t?"undefined":e(t)))return!1;var r=a(t);if(!r)return!1;var i=u.call(r,"constructor")&&r.constructor;return"function"!=typeof i?null===n:"function"==typeof i&&null!==n&&c.call(i)===c.call(n)}function d(e){return!(!e||"Object"!==h(e))&&(!a(e)||p(e,Object))}function y(t){return t&&"object"===(void 0===t?"undefined":e(t))}function v(o){var s=[],a=[],u={},c=this.types={},h=this.stringify=function(e,t,n,r){r=Object.assign({},o,r,{stringification:!0});var s=A(e,null,r);return i(s)?JSON.stringify(s[0],t,n):s.then(function(e){return JSON.stringify(e,t,n)})};this.stringifySync=function(e,t,n,r){return h(e,t,n,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!0}))},this.stringifyAsync=function(e,t,n,r){return h(e,t,n,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!1}))};var m=this.parse=function(e,t,n){return n=Object.assign({},o,n,{parse:!0}),S(JSON.parse(e,t),n)};this.parseSync=function(e,t,n){return m(e,t,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!0}))},this.parseAsync=function(e,t,n){return m(e,t,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!1}))},this.specialTypeNames=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.returnTypeNames=!0,this.encapsulate(e,t,n)},this.rootTypeName=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.iterateNone=!0,this.encapsulate(e,t,n)};var A=this.encapsulate=function(c,l,h){var b=(h=Object.assign({sync:!0},o,h)).sync,m={},w=[],O=[],A=[],S=!(h&&"cyclic"in h)||h.cyclic,T=h.encapsulateObserver,N=B("",c,S,l||{},A);function j(e){var t=Object.values(m);if(h.iterateNone)return t.length?t[0]:v.getJSONType(e);if(t.length){if(h.returnTypeNames)return[].concat(n(new Set(t)));e&&d(e)&&!e.hasOwnProperty("$types")?e.$types=m:e={$:e,$types:{$:m}}}else y(e)&&e.hasOwnProperty("$types")&&(e={$:e,$types:!0});return!h.returnTypeNames&&e}return A.length?b&&h.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(function e(n,r){return Promise.all(r.map(function(e){return e[1].p})).then(function(i){return Promise.all(i.map(function(i){var o=[],s=r.splice(0,1)[0],a=t(s,7),u=a[0],c=a[2],f=a[3],l=a[4],h=a[5],d=a[6],y=B(u,i,c,f,o,!0,d),v=p(y,E);return u&&v?y.p.then(function(t){return l[h]=t,e(n,o)}):(u?l[h]=y:n=v?y.p:y,e(n,o))}))}).then(function(){return n})}(N,A)).then(j):!b&&h.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():h.stringification&&b?[j(N)]:b?j(N):Promise.resolve(j(N));function _(e,t,n){Object.assign(e,t);var r=f.map(function(t){var n=e[t];return delete e[t],n});n(),f.forEach(function(t,n){e[t]=r[n]})}function B(t,n,o,a,u,c,f){var l=void 0,y={},b=void 0===n?"undefined":e(n),A=T?function(e){var r=f||a.type||v.getJSONType(n);T(Object.assign(e||y,{keypath:t,value:n,cyclic:o,stateObj:a,promisesData:u,resolvingTypesonPromise:c,awaitingTypesonPromise:p(n,E)},void 0!==r?{type:r}:{}))}:null;if(b in{string:1,boolean:1,number:1,undefined:1})return void 0===n||"number"===b&&(isNaN(n)||n===-1/0||n===1/0)?(l=x(t,n,a,u,!1,c,A))!==n&&(y={replaced:l}):l=n,A&&A(),l;if(null===n)return A&&A(),n;if(o&&!a.iterateIn&&!a.iterateUnsetNumeric){var S=w.indexOf(n);if(!(S<0))return m[t]="#",A&&A({cyclicKeypath:O[S]}),"#"+O[S];!0===o&&(w.push(n),O.push(t))}var N=d(n),j=i(n),C=(N||j)&&(!s.length||a.replaced)||a.iterateIn?n:x(t,n,a,u,N||j,null,A),U=void 0;if(C!==n?(l=C,y={replaced:C}):j||"array"===a.iterateIn?(U=new Array(n.length),y={clone:U}):N||"object"===a.iterateIn?y={clone:U={}}:""===t&&p(n,E)?(u.push([t,n,o,a,void 0,void 0,a.type]),l=n):l=n,A&&A(),h.iterateNone)return U||l;if(!U)return l;if(a.iterateIn){var I=function(e){var r={ownKeys:n.hasOwnProperty(e)};_(a,r,function(){var r=t+(t?".":"")+g(e),i=B(r,n[e],!!o,a,u,c);p(i,E)?u.push([r,i,!!o,a,U,e,a.type]):void 0!==i&&(U[e]=i)})};for(var L in n)I(L);A&&A({endIterateIn:!0,end:!0})}else r(n).forEach(function(e){var r=t+(t?".":"")+g(e);_(a,{ownKeys:!0},function(){var t=B(r,n[e],!!o,a,u,c);p(t,E)?u.push([r,t,!!o,a,U,e,a.type]):void 0!==t&&(U[e]=t)})}),A&&A({endIterateOwn:!0,end:!0});if(a.iterateUnsetNumeric){for(var P=n.length,k=function(e){if(!(e in n)){var r=t+(t?".":"")+e;_(a,{ownKeys:!1},function(){var t=B(r,void 0,!!o,a,u,c);p(t,E)?u.push([r,t,!!o,a,U,e,a.type]):void 0!==t&&(U[e]=t)})}},R=0;R<P;R++)k(R);A&&A({endIterateUnsetNumeric:!0,end:!0})}return U}function x(e,t,n,r,i,o,c){for(var f=i?s:a,l=f.length;l--;){var h=f[l];if(h.test(t,n)){var p=h.type;if(u[p]){var d=m[e];m[e]=d?[p].concat(d):p}return Object.assign(n,{type:p,replaced:!0}),!b&&h.replaceAsync||h.replace?(c&&c({replacing:!0}),B(e,h[b||!h.replaceAsync?"replace":"replaceAsync"](t,n),S&&"readonly",n,r,o,p)):(c&&c({typeDetected:!0}),B(e,t,S&&"readonly",n,r,o,p))}}return t}};this.encapsulateSync=function(e,t,n){return A(e,t,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!0}))},this.encapsulateAsync=function(e,t,n){return A(e,t,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!1}))};var S=this.revive=function(e,n){var s=(n=Object.assign({sync:!0},o,n)).sync,a=e&&e.$types,c=!0;if(!a)return e;if(!0===a)return e.$;a.$&&d(a.$)&&(e=e.$,a=a.$,c=!1);var f=[],h={},y=function e(n,o,s,l,y,v){if(!c||"$types"!==n){var b=a[n];if(i(o)||d(o)){var m=i(o)?new Array(o.length):{};for(r(o).forEach(function(t){var r=e(n+(n?".":"")+g(t),o[t],s||m,l,m,t);p(r,O)?m[t]=void 0:void 0!==r&&(m[t]=r)}),o=m;f.length;){var E=t(f[0],4),A=E[0],S=E[1],T=E[2],N=E[3],j=w(A,S);if(p(j,O))T[N]=void 0;else{if(void 0===j)break;T[N]=j}f.splice(0,1)}}if(!b)return o;if("#"===b){var _=w(s,o.substr(1));return void 0===_&&f.push([s,o.substr(1),y,v]),_}var B=l.sync;return[].concat(b).reduce(function(e,t){var n=u[t];if(!n)throw new Error("Unregistered type: "+t);return n[B&&n.revive?"revive":!B&&n.reviveAsync?"reviveAsync":"revive"](e,h)},o)}}("",e,null,n);return l(y=p(y,O)?void 0:y)?s&&n.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():y:!s&&n.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():s?y:Promise.resolve(y)};this.reviveSync=function(e,t){return S(e,Object.assign({},{throwOnBadSyncType:!0},t,{sync:!0}))},this.reviveAsync=function(e,t){return S(e,Object.assign({},{throwOnBadSyncType:!0},t,{sync:!1}))},this.register=function(e,t){return t=t||{},[].concat(e).forEach(function e(n){if(i(n))return n.map(e);n&&r(n).forEach(function(e){if("#"===e)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(v.JSON_TYPES.includes(e))throw new TypeError("Plain JSON object types are reserved as type names");var r=n[e],o=r.testPlainObjects?s:a,f=o.filter(function(t){return t.type===e});if(f.length&&(o.splice(o.indexOf(f[0]),1),delete u[e],delete c[e]),r){if("function"==typeof r){var l=r;r={test:function(e){return e&&e.constructor===l},replace:function(e){return b({},e)},revive:function(e){return b(Object.create(l.prototype),e)}}}else i(r)&&(r={test:r[0],replace:r[1],revive:r[2]});var h={type:e,test:r.test.bind(r)};r.replace&&(h.replace=r.replace.bind(r)),r.replaceAsync&&(h.replaceAsync=r.replaceAsync.bind(r));var p="number"==typeof t.fallback?t.fallback:t.fallback?0:1/0;if(r.testPlainObjects?s.splice(p,0,h):a.splice(p,0,h),r.revive||r.reviveAsync){var d={};r.revive&&(d.revive=r.revive.bind(r)),r.reviveAsync&&(d.reviveAsync=r.reviveAsync.bind(r)),u[e]=d}c[e]=r}})}),this}}function b(e,t){return r(t).map(function(n){e[n]=t[n]}),e}function g(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function m(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function w(e,t){if(""===t)return e;var n=t.indexOf(".");if(n>-1){var r=e[m(t.substr(0,n))];return void 0===r?void 0:w(r,t.substr(n+1))}return e[m(t)]}function O(){}function E(e){this.p=new Promise(e)}E.prototype.then=function(e,t){var n=this;return new E(function(r,i){n.p.then(function(t){r(e?e(t):t)},function(e){n.p.catch(function(e){return t?t(e):Promise.reject(e)}).then(r,i)})})},E.prototype.catch=function(e){return this.then(null,e)},E.resolve=function(e){return new E(function(t){t(e)})},E.reject=function(e){return new E(function(t,n){n(e)})},["all","race"].map(function(e){E[e]=function(t){return new E(function(n,r){Promise[e](t.map(function(e){return e.p})).then(n,r)})}}),v.Undefined=O,v.Promise=E,v.isThenable=l,v.toStringTag=h,v.hasConstructorOf=p,v.isObject=y,v.isPlainObject=d,v.isUserObject=function e(t){if(!t||"Object"!==h(t))return!1;var n=a(t);return!n||p(t,Object)||e(n)},v.escapeKeyPathComponent=g,v.unescapeKeyPathComponent=m,v.getByKeyPath=w,v.getJSONType=function(t){return null===t?"null":i(t)?"array":void 0===t?"undefined":e(t)},v.JSON_TYPES=["null","boolean","number","string","array","object"];for(var A={userObject:{test:function(e,t){return v.isUserObject(e)},replace:function(e){return Object.assign({},e)},revive:function(e){return e}}},S=[[{sparseArrays:{testPlainObjects:!0,test:function(e){return Array.isArray(e)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e}}},{sparseUndefined:{test:function(e,t){return void 0===e&&!1===t.ownKeys},replace:function(e){return null},revive:function(e){}}}],{undef:{test:function(e,t){return void 0===e&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return null},revive:function(e){return new v.Undefined}}}],T={StringObject:{test:function(t){return"String"===v.toStringTag(t)&&"object"===(void 0===t?"undefined":e(t))},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(t){return"Boolean"===v.toStringTag(t)&&"object"===(void 0===t?"undefined":e(t))},replace:function(e){return Boolean(e)},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(t){return"Number"===v.toStringTag(t)&&"object"===(void 0===t?"undefined":e(t))},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},N=[{nan:{test:function(e){return"number"==typeof e&&isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return NaN}}},{infinity:{test:function(e){return e===1/0},replace:function(e){return"Infinity"},revive:function(e){return 1/0}}},{negativeInfinity:{test:function(e){return e===-1/0},replace:function(e){return"-Infinity"},revive:function(e){return-1/0}}}],j={date:{test:function(e){return"Date"===v.toStringTag(e)},replace:function(e){var t=e.getTime();return isNaN(t)?"NaN":t},revive:function(e){return"NaN"===e?new Date(NaN):new Date(e)}}},_={regexp:{test:function(e){return"RegExp"===v.toStringTag(e)},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,n=e.flags;return new RegExp(t,n)}}},B={map:{test:function(e){return"Map"===v.toStringTag(e)},replace:function(e){return Array.from(e.entries())},revive:function(e){return new Map(e)}}},x={set:{test:function(e){return"Set"===v.toStringTag(e)},replace:function(e){return Array.from(e.values())},revive:function(e){return new Set(e)}}},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",U=new Uint8Array(256),I=0;I<C.length;I++)U[C.charCodeAt(I)]=I;var L=function(e,t,n){for(var r=new Uint8Array(e,t,n),i=r.length,o="",s=0;s<i;s+=3)o+=C[r[s]>>2],o+=C[(3&r[s])<<4|r[s+1]>>4],o+=C[(15&r[s+1])<<2|r[s+2]>>6],o+=C[63&r[s+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},P=function(e){var t=e.length,n=.75*e.length,r=0,i=void 0,o=void 0,s=void 0,a=void 0;"="===e[e.length-1]&&(n--,"="===e[e.length-2]&&n--);for(var u=new ArrayBuffer(n),c=new Uint8Array(u),f=0;f<t;f+=4)i=U[e.charCodeAt(f)],o=U[e.charCodeAt(f+1)],s=U[e.charCodeAt(f+2)],a=U[e.charCodeAt(f+3)],c[r++]=i<<2|o>>4,c[r++]=(15&o)<<4|s>>2,c[r++]=(3&s)<<6|63&a;return u},k={arraybuffer:{test:function(e){return"ArrayBuffer"===v.toStringTag(e)},replace:function(e,t){t.buffers||(t.buffers=[]);var n=t.buffers.indexOf(e);return n>-1?{index:n}:(t.buffers.push(e),L(e))},revive:function(t,n){if(n.buffers||(n.buffers=[]),"object"===(void 0===t?"undefined":e(t)))return n.buffers[t.index];var r=P(t);return n.buffers.push(r),r}}},R="undefined"==typeof self?s:self,F={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(e){var t=e,n=R[t];n&&(F[e.toLowerCase()]={test:function(e){return v.toStringTag(e)===t},replace:function(e,t){var n=e.buffer,r=e.byteOffset,i=e.length;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(n);return o>-1?{index:o,byteOffset:r,length:i}:(t.buffers.push(n),{encoded:L(n),byteOffset:r,length:i})},revive:function(e,t){t.buffers||(t.buffers=[]);var r=e.byteOffset,i=e.length,o=e.encoded,s=e.index,a=void 0;return"index"in e?a=t.buffers[s]:(a=P(o),t.buffers.push(a)),new n(a,r,i)}})});var D={dataview:{test:function(e){return"DataView"===v.toStringTag(e)},replace:function(e,t){var n=e.buffer,r=e.byteOffset,i=e.byteLength;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(n);return o>-1?{index:o,byteOffset:r,byteLength:i}:(t.buffers.push(n),{encoded:L(n),byteOffset:r,byteLength:i})},revive:function(e,t){t.buffers||(t.buffers=[]);var n=e.byteOffset,r=e.byteLength,i=e.encoded,o=e.index,s=void 0;return"index"in e?s=t.buffers[o]:(s=P(i),t.buffers.push(s)),new DataView(s,n,r)}}},J={IntlCollator:{test:function(e){return v.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return v.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return v.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function M(e){for(var t=new Uint16Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer}var K={file:{test:function(e){return"File"===v.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.open("GET",URL.createObjectURL(e),!1),"undefined"!=typeof TextEncoder&&t.overrideMimeType("text/plain; charset=utf-16le"),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return t.send(),{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,n=e.type,r=e.stringContents,i=e.lastModified,o=M(r);return new File([o],t,{type:n,lastModified:i})},replaceAsync:function(e){return new v.Promise(function(t,n){if(e.isClosed)n(new Error("The File is closed"));else{var r=new FileReader;r.addEventListener("load",function(){t({type:e.type,stringContents:r.result,name:e.name,lastModified:e.lastModified})}),r.addEventListener("error",function(){n(r.error)}),r.readAsText(e,"UTF-16")}})}}};return[A,S,T,N,j,_,{imagedata:{test:function(e){return"ImageData"===v.toStringTag(e)},replace:function(e){return{array:Array.from(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return"ImageBitmap"===v.toStringTag(e)||e&&e.dataset&&"ImageBitmap"===e.dataset.toStringTag},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=document.createElement("img");return r.onload=function(){n.drawImage(r,0,0)},r.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=document.createElement("img");return r.onload=function(){n.drawImage(r,0,0)},r.src=e,createImageBitmap(t)}}},K,{file:K.file,filelist:{test:function(e){return"FileList"===v.toStringTag(e)},replace:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e.item(n);return t},revive:function(e){function t(){this._files=arguments[0],this.length=this._files.length}return t.prototype.item=function(e){return this._files[e]},t.prototype[Symbol.toStringTag]="FileList",new t(e)}}},{blob:{test:function(e){return"Blob"===v.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.open("GET",URL.createObjectURL(e),!1),"undefined"!=typeof TextEncoder&&t.overrideMimeType("text/plain; charset=utf-16le"),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return t.send(),{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,n=e.stringContents;return new Blob([M(n)],{type:t})},replaceAsync:function(e){return new v.Promise(function(t,n){if(e.isClosed)n(new Error("The Blob is closed"));else{var r=new FileReader;r.addEventListener("load",function(){t({type:e.type,stringContents:r.result})}),r.addEventListener("error",function(){n(r.error)}),r.readAsText(e,"UTF-16")}})}}}].concat("function"==typeof Map?B:[],"function"==typeof Set?x:[],"function"==typeof ArrayBuffer?k:[],"function"==typeof Uint8Array?F:[],"function"==typeof DataView?D:[],"undefined"!=typeof Intl?J:[])}()});const f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=new Uint8Array(256);for(let e=0;e<f.length;e++)l[f.charCodeAt(e)]=e;const h=function(e,t,n){const r=new Uint8Array(e,t,n),i=r.length;let o="";for(let e=0;e<i;e+=3)o+=f[r[e]>>2],o+=f[(3&r[e])<<4|r[e+1]>>4],o+=f[(15&r[e+1])<<2|r[e+2]>>6],o+=f[63&r[e+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},p=function(e){const t=e.length;let n,r,i,o,s=.75*e.length,a=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);const u=new ArrayBuffer(s),c=new Uint8Array(u);for(let s=0;s<t;s+=4)n=l[e.charCodeAt(s)],r=l[e.charCodeAt(s+1)],i=l[e.charCodeAt(s+2)],o=l[e.charCodeAt(s+3)],c[a++]=n<<2|r>>4,c[a++]=(15&r)<<4|i>>2,c[a++]=(3&i)<<6|63&o;return u};var d="undefined"==typeof self?global:self,y={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(e){var t=e,n=d[t];n&&(y[e.toLowerCase()+"2"]={test:function(e){return u.toStringTag(e)===t},replace:function(e){return{buffer:e.buffer,byteOffset:e.byteOffset,length:e.length}},revive:function(e){var t=e.buffer,r=e.byteOffset,i=e.length;return new n(t,r,i)}})});var v={arraybuffer:{test:function(e){return"ArrayBuffer"===u.toStringTag(e)},replace:function(e){return h(e,0,e.byteLength)},revive:function(e){return p(e)}}},b=(new u).register(c),g="FileReaderSync"in self,m=[],w=0;b.register([v,y,{blob2:{test:function(e){return"Blob"===u.toStringTag(e)},replace:function(e){if(e.isClosed)throw new Error("The Blob is closed");if(g){var t=o(e,"binary"),n=h(t,0,t.byteLength);return{type:e.type,data:n}}m.push(e);var r={type:e.type,data:{start:w,end:w+e.size}};return console.log("b.size: "+e.size),w+=e.size,r},finalize:function(e,t){e.data=h(t,0,t.byteLength)},revive:function(e){var t=e.type,n=e.data;return new Blob([p(n)],{type:t})}}}]),b.mustFinalize=function(){return m.length>0},b.finalize=function(e){return n(void 0,void 0,void 0,function(){var n,o,s,a,u,c,f,l,h,p;return r(this,function(r){switch(r.label){case 0:return[4,i(new Blob(m),"binary")];case 1:if(n=r.sent(),e)for(o=0,s=e;o<s.length;o++)if((a=s[o]).$types)for(f in u=a.$types,(c=u.$)&&(u=u.$),u)l=u[f],(h=b.types[l])&&h.finalize&&(p=t.getByKeyPath(a,c?"$."+f:f),h.finalize(p,n.slice(p.start,p.end)));return m=[],[2]}})})};var O=2e3;function E(e,i){return n(this,void 0,void 0,function(){function o(){return n(this,void 0,void 0,function(){var n,o,h,p,d,y,v,g,m;return r(this,function(w){switch(w.label){case 0:return[4,Promise.all(e.tables.map(function(e){return e.count()}))];case 1:(n=w.sent()).forEach(function(e,t){return a[t].rowCount=e}),l.totalRows=n.reduce(function(e,t){return e+t}),o=JSON.stringify(c,void 0,u?2:void 0),h=o.lastIndexOf("]"),p=o.substring(0,h),s.push(p),d=i.filter,y=function(n){var o,a,c,h,p,y,v,g,m,w,E;return r(this,function(A){switch(A.label){case 0:o=e.table(n),a=o.schema.primKey,c=!!a.keyPath,h=i.numRowsPerChunk||O,p=c?{tableName:o.name,inbound:!0,rows:[]}:{tableName:o.name,inbound:!1,rows:[]},y=JSON.stringify(p,void 0,u?2:void 0),u&&(y=y.split("\n").join("\n    ")),v=y.lastIndexOf("]"),s.push(y.substring(0,v)),g=null,m=0,w=!0,E=function(){var e,i,p,y,v,O,E,A;return r(this,function(r){switch(r.label){case 0:return f&&t.ignoreTransaction(function(){return f(l)}),[4,(e=null==g?o.limit(h):o.where(":id").above(g).limit(h)).toArray()];case 1:return 0===(i=r.sent()).length?[2,"break"]:(null!=g&&m>0&&(s.push(","),u&&s.push("\n      ")),w=i.length===h,c?(p=d?i.filter(function(e){return d(n,e)}):i,y=p.map(function(e){return b.encapsulate(e)}),b.mustFinalize()?[4,t.waitFor(b.finalize(y))]:[3,3]):[3,4]);case 2:r.sent(),r.label=3;case 3:return A=JSON.stringify(y,void 0,u?2:void 0),u&&(A=A.split("\n").join("\n      ")),s.push(new Blob([A.substring(1,A.length-1)])),m=p.length,g=i.length>0?t.getByKeyPath(i[i.length-1],a.keyPath):null,[3,8];case 4:return[4,e.primaryKeys()];case 5:return v=r.sent(),O=v.map(function(e,t){return[e,i[t]]}),d&&(O=O.filter(function(e){var t=e[0],r=e[1];return d(n,r,t)})),E=O.map(function(e){return b.encapsulate(e)}),b.mustFinalize()?[4,t.waitFor(b.finalize(E))]:[3,7];case 6:r.sent(),r.label=7;case 7:A=JSON.stringify(E,void 0,u?2:void 0),u&&(A=A.split("\n").join("\n      ")),s.push(new Blob([A.substring(1,A.length-1)])),m=O.length,g=v.length>0?v[v.length-1]:null,r.label=8;case 8:return l.completedRows+=i.length,[2]}})},A.label=1;case 1:return w?[5,E()]:[3,3];case 2:return"break"===A.sent()?[3,3]:[3,1];case 3:return s.push(y.substr(v)),l.completedTables+=1,l.completedTables<l.totalTables&&s.push(","),[2]}})},v=0,g=a,w.label=2;case 2:return v<g.length?(m=g[v].name,[5,y(m)]):[3,5];case 3:w.sent(),w.label=4;case 4:return v++,[3,2];case 5:return s.push(o.substr(h)),l.done=!0,f&&t.ignoreTransaction(function(){return f(l)}),[2]}})})}var s,a,u,c,f,l;return r(this,function(n){switch(n.label){case 0:i=i||{},s=[],a=e.tables.map(function(e){return{name:e.name,schema:function(e){return[e.schema.primKey].concat(e.schema.indexes).map(function(e){return e.src}).join(",")}(e),rowCount:0}}),u=i.prettyJson,c={formatName:"dexie",formatVersion:1,data:{databaseName:e.name,databaseVersion:e.verno,tables:a,data:[]}},f=i.progressCallback,l={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:e.tables.length},n.label=1;case 1:return n.trys.push([1,,6,7]),i.noTransaction?[4,o()]:[3,3];case 2:return n.sent(),[3,5];case 3:return[4,e.transaction("r",e.tables,o)];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:return b.finalize(),[7];case 7:return f&&t.ignoreTransaction(function(){return f(l)}),[2,new Blob(s,{type:"text/json"})]}})})}var A=1,S=function(){},T=a(function(e,t){!function(e){var t="object"==typeof process&&process.env?process.env:self;e.parser=function(e){return new f(e)},e.CParser=f,e.CStream=l,e.createStream=function(e){return new l(e)},e.MAX_BUFFER_LENGTH=65536,e.DEBUG="debug"===t.CDEBUG,e.INFO="debug"===t.CDEBUG||"info"===t.CDEBUG,e.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var n,r={textNode:void 0,numberNode:""},i=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e}),o=0;for(var s in e.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++},e.STATE)e.STATE[e.STATE[s]]=s;o=e.STATE;const a={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};function u(e){for(var t in r)e[t]=r[t]}Object.create||(Object.create=function(e){function t(){this.__proto__=e}return t.prototype=e,new t}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t});var c=/[\\"\n]/g;function f(t){if(!(this instanceof f))return new f(t);u(this),this.bufferCheckPosition=e.MAX_BUFFER_LENGTH,this.q=this.c=this.p="",this.opt=t||{},this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.state=o.BEGIN,this.stack=new Array,this.position=this.column=0,this.line=1,this.slashed=!1,this.unicodeI=0,this.unicodeS=null,this.depth=0,h(this,"onready")}f.prototype={end:function(){b(this)},write:function(t){if(this.error)throw this.error;if(this.closed)return v(this,"Cannot write after close. Assign an onready handler.");if(null===t)return b(this);var n=0,i=t.charCodeAt(0),s=this.p;e.DEBUG&&console.log("write -> ["+t+"]");for(;i&&(s=i,this.c=i=t.charCodeAt(n++),s!==i?this.p=s:s=this.p,i);)switch(e.DEBUG&&console.log(n,i,e.STATE[this.state]),this.position++,i===a.lineFeed?(this.line++,this.column=0):this.column++,this.state){case o.BEGIN:i===a.openBrace?this.state=o.OPEN_OBJECT:i===a.openBracket?this.state=o.OPEN_ARRAY:g(i)||v(this,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(g(i))continue;if(this.state===o.OPEN_KEY)this.stack.push(o.CLOSE_KEY);else{if(i===a.closeBrace){h(this,"onopenobject"),this.depth++,h(this,"oncloseobject"),this.depth--,this.state=this.stack.pop()||o.VALUE;continue}this.stack.push(o.CLOSE_OBJECT)}i===a.doubleQuote?this.state=o.STRING:v(this,'Malformed object key should start with "');continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(g(i))continue;this.state,o.CLOSE_KEY;i===a.colon?(this.state===o.CLOSE_OBJECT?(this.stack.push(o.CLOSE_OBJECT),d(this,"onopenobject"),this.depth++):d(this,"onkey"),this.state=o.VALUE):i===a.closeBrace?(p(this,"oncloseobject"),this.depth--,this.state=this.stack.pop()||o.VALUE):i===a.comma?(this.state===o.CLOSE_OBJECT&&this.stack.push(o.CLOSE_OBJECT),d(this),this.state=o.OPEN_KEY):v(this,"Bad object");continue;case o.OPEN_ARRAY:case o.VALUE:if(g(i))continue;if(this.state===o.OPEN_ARRAY){if(h(this,"onopenarray"),this.depth++,this.state=o.VALUE,i===a.closeBracket){h(this,"onclosearray"),this.depth--,this.state=this.stack.pop()||o.VALUE;continue}this.stack.push(o.CLOSE_ARRAY)}i===a.doubleQuote?this.state=o.STRING:i===a.openBrace?this.state=o.OPEN_OBJECT:i===a.openBracket?this.state=o.OPEN_ARRAY:i===a.t?this.state=o.TRUE:i===a.f?this.state=o.FALSE:i===a.n?this.state=o.NULL:i===a.minus?this.numberNode+="-":a._0<=i&&i<=a._9?(this.numberNode+=String.fromCharCode(i),this.state=o.NUMBER_DIGIT):v(this,"Bad value");continue;case o.CLOSE_ARRAY:if(i===a.comma)this.stack.push(o.CLOSE_ARRAY),d(this,"onvalue"),this.state=o.VALUE;else if(i===a.closeBracket)p(this,"onclosearray"),this.depth--,this.state=this.stack.pop()||o.VALUE;else{if(g(i))continue;v(this,"Bad array")}continue;case o.STRING:void 0===this.textNode&&(this.textNode="");var u=n-1,f=this.slashed,l=this.unicodeI;e:for(;;){for(e.DEBUG&&console.log(n,i,e.STATE[this.state],f);l>0;)if(this.unicodeS+=String.fromCharCode(i),i=t.charCodeAt(n++),this.position++,4===l?(this.textNode+=String.fromCharCode(parseInt(this.unicodeS,16)),l=0,u=n-1):l++,!i)break e;if(i===a.doubleQuote&&!f){this.state=this.stack.pop()||o.VALUE,this.textNode+=t.substring(u,n-1),this.position+=n-1-u;break}if(i===a.backslash&&!f&&(f=!0,this.textNode+=t.substring(u,n-1),this.position+=n-1-u,i=t.charCodeAt(n++),this.position++,!i))break;if(f){if(f=!1,i===a.n?this.textNode+="\n":i===a.r?this.textNode+="\r":i===a.t?this.textNode+="\t":i===a.f?this.textNode+="\f":i===a.b?this.textNode+="\b":i===a.u?(l=1,this.unicodeS=""):this.textNode+=String.fromCharCode(i),i=t.charCodeAt(n++),this.position++,u=n-1,i)continue;break}c.lastIndex=n;var m=c.exec(t);if(null===m){n=t.length+1,this.textNode+=t.substring(u,n-1),this.position+=n-1-u;break}if(n=m.index+1,!(i=t.charCodeAt(m.index))){this.textNode+=t.substring(u,n-1),this.position+=n-1-u;break}}this.slashed=f,this.unicodeI=l;continue;case o.TRUE:i===a.r?this.state=o.TRUE2:v(this,"Invalid true started with t"+i);continue;case o.TRUE2:i===a.u?this.state=o.TRUE3:v(this,"Invalid true started with tr"+i);continue;case o.TRUE3:i===a.e?(h(this,"onvalue",!0),this.state=this.stack.pop()||o.VALUE):v(this,"Invalid true started with tru"+i);continue;case o.FALSE:i===a.a?this.state=o.FALSE2:v(this,"Invalid false started with f"+i);continue;case o.FALSE2:i===a.l?this.state=o.FALSE3:v(this,"Invalid false started with fa"+i);continue;case o.FALSE3:i===a.s?this.state=o.FALSE4:v(this,"Invalid false started with fal"+i);continue;case o.FALSE4:i===a.e?(h(this,"onvalue",!1),this.state=this.stack.pop()||o.VALUE):v(this,"Invalid false started with fals"+i);continue;case o.NULL:i===a.u?this.state=o.NULL2:v(this,"Invalid null started with n"+i);continue;case o.NULL2:i===a.l?this.state=o.NULL3:v(this,"Invalid null started with nu"+i);continue;case o.NULL3:i===a.l?(h(this,"onvalue",null),this.state=this.stack.pop()||o.VALUE):v(this,"Invalid null started with nul"+i);continue;case o.NUMBER_DECIMAL_POINT:i===a.period?(this.numberNode+=".",this.state=o.NUMBER_DIGIT):v(this,"Leading zero not followed by .");continue;case o.NUMBER_DIGIT:a._0<=i&&i<=a._9?this.numberNode+=String.fromCharCode(i):i===a.period?(-1!==this.numberNode.indexOf(".")&&v(this,"Invalid number has two dots"),this.numberNode+="."):i===a.e||i===a.E?(-1===this.numberNode.indexOf("e")&&-1===this.numberNode.indexOf("E")||v(this,"Invalid number has two exponential"),this.numberNode+="e"):i===a.plus||i===a.minus?(s!==a.e&&s!==a.E&&v(this,"Invalid symbol in number"),this.numberNode+=String.fromCharCode(i)):(y(this),n--,this.state=this.stack.pop()||o.VALUE);continue;default:v(this,"Unknown state: "+this.state)}this.position>=this.bufferCheckPosition&&function(t){var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0;for(var o in r){var s=void 0===t[o]?0:t[o].length;if(s>n)switch(o){case"text":closeText(t);break;default:v(t,"Max buffer length exceeded: "+o)}i=Math.max(i,s)}t.bufferCheckPosition=e.MAX_BUFFER_LENGTH-i+t.position}(this);return this},resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{n=S}catch(e){n=function(){}}function l(e){if(!(this instanceof l))return new l(e);this._parser=new f(e),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var t=this;n.apply(t),this._parser.onend=function(){t.emit("end")},this._parser.onerror=function(e){t.emit("error",e),t._parser.error=null},i.forEach(function(e){Object.defineProperty(t,"on"+e,{get:function(){return t._parser["on"+e]},set:function(n){if(!n)return t.removeAllListeners(e),t._parser["on"+e]=n,n;t.on(e,n)},enumerable:!0,configurable:!1})})}function h(t,n,r){e.INFO&&console.log("-- emit",n,r),t[n]&&t[n](r)}function p(e,t,n){d(e),h(e,t,n)}function d(e,t){e.textNode=function(e,t){if(void 0===t)return t;e.trim&&(t=t.trim());e.normalize&&(t=t.replace(/\s+/g," "));return t}(e.opt,e.textNode),void 0!==e.textNode&&h(e,t||"onvalue",e.textNode),e.textNode=void 0}function y(e){e.numberNode&&h(e,"onvalue",parseFloat(e.numberNode)),e.numberNode=""}function v(e,t){return d(e),t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c,t=new Error(t),e.error=t,h(e,"onerror",t),e}function b(e){return e.state===o.VALUE&&0===e.depth||v(e,"Unexpected end"),d(e),e.c="",e.closed=!0,h(e,"onend"),f.call(e,e.opt),e}function g(e){return e===a.carriageReturn||e===a.lineFeed||e===a.space||e===a.tab}l.prototype=Object.create(n.prototype,{constructor:{value:l}}),l.prototype.write=function(e){e=new Buffer(e);for(var t=0;t<e.length;t++){var n=e[t];if(this.bytes_remaining>0){for(var r=0;r<this.bytes_remaining;r++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+r]=e[r];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,t=t+r-1,this._parser.write(this.string),this.emit("data",this.string)}else if(0===this.bytes_remaining&&n>=128){if(n>=194&&n<=223&&(this.bytes_in_sequence=2),n>=224&&n<=239&&(this.bytes_in_sequence=3),n>=240&&n<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+t>e.length){for(var i=0;i<=e.length-1-t;i++)this.temp_buffs[this.bytes_in_sequence][i]=e[t+i];return this.bytes_remaining=t+this.bytes_in_sequence-e.length,!0}this.string=e.slice(t,t+this.bytes_in_sequence).toString(),t=t+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string)}else{for(var o=t;o<e.length&&!(e[o]>=128);o++);this.string=e.slice(t,o).toString(),this._parser.write(this.string),this.emit("data",this.string),t=o-1}}},l.prototype.end=function(e){return e&&e.length&&this._parser.write(e.toString()),this._parser.end(),!0},l.prototype.on=function(e,t){var r=this;return r._parser["on"+e]||-1===i.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),n.prototype.on.call(r,e,t)},l.prototype.destroy=function(){u(this._parser),this.emit("close")}}(t)});function N(e){var t=0,s=function(e){var t,n,r,i=T.parser(),o=0,s=[],a=!1,u=!1;return i.onopenobject=function(i){var a={incomplete:!0};t||(t=a),n&&(s.push([r,n,u]),e&&(u?n.push(a):n[r]=a)),n=a,r=i,u=!1,++o},i.onkey=function(e){return r=e},i.onvalue=function(e){return u?n.push(e):n[r]=e},i.oncloseobject=function(){var t;if(delete n.incomplete,r=null,0==--o)a=!0;else{var i=n;t=s.pop(),r=t[0],n=t[1],u=t[2],e||(u?n.push(i):n[r]=i)}},i.onopenarray=function(){var i=[];i.incomplete=!0,t||(t=i),n&&(s.push([r,n,u]),e&&(u?n.push(i):n[r]=i)),n=i,u=!0,r=null,++o},i.onclosearray=function(){var t;if(delete n.incomplete,r=null,0==--o)a=!0;else{var i=n;t=s.pop(),r=t[0],n=t[1],u=t[2],e||(u?n.push(i):n[r]=i)}},{write:function(e){return i.write(e),t},done:function(){return a}}}(!0),a={pullAsync:function(o){return n(this,void 0,void 0,function(){var n,u,c;return r(this,function(r){switch(r.label){case 0:return n=e.slice(t,t+o),t+=o,[4,i(n,"text")];case 1:return u=r.sent(),c=s.write(u),a.result=c||{},[2,c]}})})},pullSync:function(n){var r=e.slice(t,t+n);t+=n;var i=o(r,"text"),u=s.write(i);return a.result=u||{},u},done:function(){return s.done()},eof:function(){return t>=e.size},result:{}};return a}var j=1024;function _(e,i){return n(this,void 0,void 0,function(){var n,o,s,a;return r(this,function(r){switch(r.label){case 0:return n=(i=i||{}).chunkSizeBytes||1024*j,[4,x(e,n)];case 1:return o=r.sent(),s=o.result.data,(a=new t(s.databaseName)).version(s.databaseVersion).stores(function(e){for(var t={},n=0,r=e.tables;n<r.length;n++){var i=r[n];t[i.name]=i.schema}return t}(s)),[4,B(a,o,i)];case 2:return r.sent(),[2,a]}})})}function B(e,i,o){return n(this,void 0,void 0,function(){function s(){return n(this,void 0,void 0,function(){var n,i,s,c;return r(this,function(d){switch(d.label){case 0:n=function(n){var i,s,a,u,c,f,d,y,v,g,m,w;return r(this,function(r){switch(r.label){case 0:if(!n.rows)return[2,"break"];if(!n.rows.incomplete&&0===n.rows.length)return[2,"continue"];if(h&&t.ignoreTransaction(function(){return h(p)}),i=n.tableName,s=e.table(i),a=l.tables.filter(function(e){return e.name===i})[0].schema,!s){if(o.acceptMissingTables)return[2,"continue"];throw new Error("Exported table "+n.tableName+" is missing in installed database")}if(!o.acceptChangedPrimaryKey&&a.split(",")[0]!=s.schema.primKey.src)throw new Error("Primary key differs for table "+n.tableName+". ");for(u=n.rows,c=[],f=0;f<u.length&&!(d=u[f]).incomplete;f++)c.push(b.revive(d));return y=o.filter,v=y?n.inbound?c.filter(function(e){return y(i,e)}):c.filter(function(e){var t=e[0],n=e[1];return y(i,n,t)}):c,g=n.inbound?[void 0,v]:[v.map(function(e){return e[0]}),c.map(function(e){return e[1]})],m=g[0],w=g[1],o.clearTablesBeforeImport?[4,s.clear()]:[3,2];case 1:r.sent(),r.label=2;case 2:return o.overwriteValues?[4,s.bulkPut(w,m)]:[3,4];case 3:return r.sent(),[3,6];case 4:return[4,s.bulkAdd(w,m)];case 5:r.sent(),r.label=6;case 6:return p.completedRows+=c.length,c.incomplete||(p.completedTables+=1),u.splice(0,c.length),[2]}})},i=0,s=l.data,d.label=1;case 1:return i<s.length?(c=s[i],[5,n(c)]):[3,4];case 2:if("break"===d.sent())return[3,4];d.label=3;case 3:return i++,[3,1];case 4:for(;l.data.length>0&&l.data[0].rows&&!l.data[0].rows.incomplete;)l.data.splice(0,1);return u.done()||u.eof()?[3,8]:f?(u.pullSync(a),[3,7]):[3,5];case 5:return[4,t.waitFor(u.pullAsync(a))];case 6:d.sent(),d.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var a,u,c,f,l,h,p;return r(this,function(n){switch(n.label){case 0:return a=(o=o||{}).chunkSizeBytes||1024*j,[4,x(i,a)];case 1:if(u=n.sent(),c=u.result,f="FileReaderSync"in self,l=c.data,!o.acceptNameDiff&&e.name!==l.databaseName)throw new Error("Name differs. Current database name is "+e.name+" but export is "+l.databaseName);if(!o.acceptVersionDiff&&e.verno!==l.databaseVersion)throw new Error("Database version differs. Current database is in version "+e.verno+" but export is "+l.databaseVersion);return h=o.progressCallback,p={done:!1,completedRows:0,completedTables:0,totalRows:l.tables.reduce(function(e,t){return e+t.rowCount},0),totalTables:l.tables.length},h&&t.ignoreTransaction(function(){return h(p)}),o.noTransaction?[4,s()]:[3,3];case 2:return n.sent(),[3,5];case 3:return[4,e.transaction("rw",e.tables,s)];case 4:n.sent(),n.label=5;case 5:return p.done=!0,h&&t.ignoreTransaction(function(){return h(p)}),[2]}})})}function x(e,t){return n(this,void 0,void 0,function(){var n,i;return r(this,function(r){switch(r.label){case 0:n="slice"in e?N(e):e,r.label=1;case 1:return n.eof()?[3,3]:[4,n.pullAsync(t)];case 2:return r.sent(),n.result.data&&n.result.data.data?[3,3]:[3,1];case 3:if(!(i=n.result)||"dexie"!=i.formatName)throw new Error("Given file is not a dexie export");if(i.formatVersion>A)throw new Error("Format version "+i.formatVersion+" not supported");if(!i.data)throw new Error("No data in export file");if(!i.data.databaseName)throw new Error("Missing databaseName in export file");if(!i.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!i.data.tables)throw new Error("Missing tables in export file");return[2,n]}})})}t.prototype.export=function(e){return E(this,e)},t.prototype.import=function(e,t){return B(this,e,t)},t.import=function(e,t){return _(e,t)};e.exportDB=E,e.importDB=_,e.importInto=B,e.default=function(){throw new Error("This addon extends Dexie.prototype globally and does not have be included in Dexie constructor's addons options.")},Object.defineProperty(e,"__esModule",{value:!0})});
